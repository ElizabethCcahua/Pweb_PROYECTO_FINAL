{% extends "base.html" %}

{% block main %}
    <div class="page-heading" id="top">
        <div class="container">
            <div class="row">
                <div class="col-lg-12">
                    <div class="inner-content">
                        <h2>Su carrito de compras</h2>
                        <span>Revise sus artículos antes de realizar el pago</span>
                    </div>
                </div>
            </div>
        </div>
    </div>
{% endblock %}

{% block content %}
<div class="cart-container">
    <h2>Tu Carrito de Compras</h2>

    {% if cart %}
    <table class="cart-table">
        <thead>
            <tr>
                <th>Producto</th>
                <th>Imagen</th>
                <th>Cantidad</th>
                <th>Precio Unitario</th>
                <th>Subtotal</th>
                <th>Acciones</th>
            </tr>
        </thead>
        <tbody>
            {% for item in cart %}
            <tr>
                <td>{{ item.name }}</td>
                <td>
                    {% if item.image %}
                        <img src="{{ item.image }}" alt="{{ item.name }}" width="100">
                    {% else %}
                        Sin imagen
                    {% endif %}
                </td>
                <td>{{ item.cant }}</td>
                <td>${{ item.price|floatformat:2 }}</td>
                <td>${{ item.subtotal|floatformat:2 }}</td> <!-- Subtotal calculado -->
                <td>
                    <a href="{% url 'cart:add' item.id %}">Aumentar</a> |
                    <a href="{% url 'cart:subtract' item.id %}">Restar</a> |
                    <a href="{% url 'cart:delete' item.id %}">Eliminar</a>
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>

    <!-- Total general -->
    <div class="cart-total">
        <h3>Total a Pagar: ${{ total_cart_amount|floatformat:2 }}</h3>
    </div>

    <!-- Botones de acciones -->
    <div class="cart-actions">
        <a href="{% url 'cart:clear' %}" class="btn">Vaciar Carrito</a>
        <a href="#" class="btn">Hacer Pedido</a>
    </div>
    {% else %}
    <p class="empty-cart">El carrito está vacío. ¡Agrega productos para comenzar!</p>
    {% endif %}
</div>
{% endblock %}


